<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Plainhouse | Official Hub</title>
  <link rel="stylesheet" href="style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
  
  <script>
    function toggleDarkMode() {
      document.body.classList.toggle('dark');
    }

    function openTab(tabName, btn) {
      const tabs = document.querySelectorAll(".tab-content");
      tabs.forEach(tab => tab.style.display = "none");
      
      const activeTab = document.getElementById(tabName);
      activeTab.style.display = "block";
      
      const buttons = document.querySelectorAll(".tab-bar button");
      buttons.forEach(b => b.classList.remove("active-btn"));
      btn.classList.add("active-btn");
    }

    window.onload = () => {
      openTab("twitch", document.querySelector(".tab-bar button")); 
    };
  </script>
</head>
<body class="dark">
  <div class="background-glow"></div>

  <header>
    <div class="banner-container">
      <img src="banner.png" alt="Plainhouse banner" class="banner" id="banner" />
    </div>
    <button onclick="toggleDarkMode()" class="toggle-button">Theme</button>
  </header>

  <nav class="tab-bar">
    <button onclick="openTab('twitch', this)">ðŸŽ® Twitch</button>
    <button onclick="openTab('youtube', this)">ðŸ“º YouTube</button>
    <button onclick="openTab('spotify', this)">ðŸŽ§ Music</button>
  </nav>

  <main>
    <section id="twitch" class="tab-content">
      <h2 class="section-title">ðŸŽ® Live Stream</h2>
      <div class="glass-card">
        <iframe src="https://player.twitch.tv/?channel=plainhouse&parent=yourdomain.com" allowfullscreen></iframe>
      </div>
    </section>

    <section id="spotify" class="tab-content">
      <h2 class="section-title">ðŸŽ§ Audio Sync</h2>
      <div class="glass-card music-sync">
        <p>Sync this site with your device's audio for a live visualizer experience.</p>
        <button id="start-audio" class="main-button">Start Visualizer</button>
        <div class="visual-wrap">
          <canvas id="visualizer-canvas"></canvas>
        </div>
        <p id="status-text" class="status-msg">Ready to detect music...</p>
      </div>
    </section>

    <section id="youtube" class="tab-content">
      <h2 class="section-title">ðŸ“º Latest Videos</h2>
      <div class="glass-card">
        <iframe src="https://www.youtube.com/embed?listType=user_uploads&list=plainhouse126"></iframe>
      </div>
    </section>
  </main>

  <footer>
    <p>Â© 2026 Plainhouse</p>
    <div class="eggs">
       <img src="youtube.png" alt="YT" class="egg-icon" onclick="window.open('https://youtube.com/@plainhouse126','_blank')">
       <img src="twitch.png" alt="TW" class="egg-icon" onclick="window.open('https://twitch.tv/plainhouse','_blank')">
    </div>
  </footer>

  <script>
    // --- VISUALIZER SCRIPT ---
    const startBtn = document.getElementById('start-audio');
    const canvas = document.getElementById('visualizer-canvas');
    const ctx = canvas.getContext('2d');
    const status = document.getElementById('status-text');

    startBtn.onclick = async () => {
      try {
        const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        const source = audioCtx.createMediaStreamSource(stream);
        const analyser = audioCtx.createAnalyser();
        analyser.fftSize = 128;
        source.connect(analyser);
        
        const bufferLength = analyser.frequencyBinCount;
        const dataArray = new Uint8Array(bufferLength);
        
        startBtn.style.display = "none";
        status.innerText = "Syncing with your device audio... ðŸŽµ";

        function draw() {
          requestAnimationFrame(draw);
          analyser.getByteFrequencyData(dataArray);
          ctx.clearRect(0, 0, canvas.width, canvas.height);
          
          let barWidth = (canvas.width / bufferLength) * 2.5;
          let x = 0;

          for(let i = 0; i < bufferLength; i++) {
            let barHeight = dataArray[i] / 2;
            ctx.fillStyle = '#00ffcc';
            ctx.shadowBlur = 10;
            ctx.shadowColor = '#00ffcc';
            ctx.fillRect(x, canvas.height - barHeight, barWidth - 2, barHeight);
            x += barWidth;
          }
        }
        draw();
      } catch (err) {
        status.innerText = "Error: Please allow audio access in your browser.";
      }
    };
  </script>
</body>
</html>